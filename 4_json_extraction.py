# 4) 구조화 출력(JSON)로 정보추출
import ollama
import json

text = """
주문 3건:
1) 상품: 무선마우스, 수량 2, 가격 25,000원
2) 상품: 기계식 키보드, 수량 1, 가격 89,000원
3) 상품: USB-C 케이블, 수량 3, 가격 9,900원
총 배송지는 서울시 강남구 테헤란로 1
"""

prompt = f"""
아래 텍스트에서 주문 항목을 JSON으로 추출해.
스키마:
{{
  "orders":[{{"item":str,"qty":int,"price_krw":int}}],
  "shipping_address": str,
  "total_price_krw": int
}}
텍스트:
{text}
반드시 JSON만 출력.
"""

resp = ollama.chat(
    model='gemma3:1b',
    messages=[{"role": "user", "content": prompt}],
    format='json',  # JSON 모드
    options={"temperature": 0}
)

data = json.loads(resp['message']['content'])
print(json.dumps(data, indent=2, ensure_ascii=False))


# ============================================================================
#  영화 리뷰 분석 - 복잡한 JSON 구조 추출 연습
# ============================================================================
"""
[미션]
영화 리뷰 텍스트에서 다음 정보를 JSON으로 추출하는 코드를 작성하세요:
- 영화 제목 (title), 감독 (director), 장르 (genre)
- 평점 (rating) - 5점 만점의 숫자
- 장점 리스트 (pros) - 문자열 배열
- 단점 리스트 (cons) - 문자열 배열
- 추션: 다른 영화 리뷰로 테스트해보세요!
# ============================================================================
"""
💡 연습 과제:
1. 위 코드를 참고하여 좋아하는 영화의 가상 리뷰를 작성하고 JSON 추출을 테스트해보세요.
2. 여러 개의 리뷰를 처리하는 반복문을 만들어보세요.
3. 추출된 JSON 데이터를 파일로 저장해보세요 (json.dump() 사용).
4. 평점이 4.0 이상이고 추천하는 영화만 필터링해보세요.

예시 리뷰 텍스트 (테스트용):
- "봉준호 감독의 '기생충'은 블랙 코미디 스릴러로, 계급 갈등을 예리하게 그려냈다..."
- "제임스 카메론의 '아바타'는 판타지 액션 영화로, 3D 기술이 혁신적이다..."
"""



